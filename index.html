<!--
Example from https://www.highcharts.com/demo/scatter
-->

<script src="js/utils.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/modules/boost.js"></script>
<!--<script src="https://code.highcharts.com/modules/exporting.js"></script>-->

<div id="container" style="min-width: 310px; height: 800px; max-width: 1500px; margin: 0 auto"></div>

<script type="text/javascript">
    function load_graph(series_data) {
        Highcharts.chart('container', {
            chart: {
                type: 'bubble',
                plotBorderWidth: 1,
                zoomType: 'xy'
            },
            title: {text: 'Vitimas fatais ao longo da semana'},
            subtitle: {
                text: 'Fonte: <a target="_blank" href="http://datapoa.com.br/dataset/acidentes-de-transito/">DataPoa</a>'
            },
            xAxis: {
                title: {
                    enabled: true,
                    text: 'Momento da semana'
                },
                startOnTick: true,
                endOnTick: true,
                showLastLabel: true,
                labels: {
                    formatter: function () {
                        return get_str(this.value);
                    }
                }
            },
            yAxis: {
                title: {text: 'Fatalidades'},
                startOnTick: false,
                endOnTick: false,
                labels: {
                    format: '{value}'
                },
                maxPadding: 0.2,
            },
            legend: {
                layout: 'vertical',
                align: 'left',
                verticalAlign: 'top',
                x: 100, y: 70,
                floating: true,
                backgroundColor: Highcharts.defaultOptions.chart.backgroundColor,
                borderWidth: 1
            },
            plotOptions: {
                series: {
                    dataLabels: {
                        enabled: true,
                        format: '{point.name}'
                    }
                }
            },
            series: series_data,
            tooltip: {
                // pointFormat: '{point.country}',
                formatter: function () {
                    return get_str(this.point.x) + ', ' + this.point.z + ' vezes com ' + this.point.y + ' fatalidades';
                },
                followPointer: true
            }
        });
    }

    $.get('dataset/2016/acidentes-2016.csv.json', function (json) {
        load_graph(json['series']);
    });
</script>